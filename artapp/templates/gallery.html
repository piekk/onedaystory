{% extends"layout.html" %}
{% block content %}
<!-- แกลอรี   -->
    <div class="break"></div>
    <div class="banner">
      <img src="{{ url_for('static', filename='image/banner/photography.png')}}" alt="รูปถ่าย รุปขาวดำ">
      <div class="text-center"><a href="{{url_for('merchantregister')}}">ลงผลงานกับเรา</a></div>
    </div>
    <div class="break"></div>
    <div class="norm">
      <h4 class="upper">{{filter}}</h4>
    </div>
    <div class= "norm">
      <span><a class="tag" href="{{url_for('home')}}">หน้าหลัก </a>|</span>
      <span><a class="tag" href="{{url_for('gallery')}}">แกลอรี </a>|</span>
      <span><a class="tag" href="{{url_for('gallery', filter='latest')}}">สินค้าใหม่</a></span>
    </div>
    <!-- Slider main container -->
    <div class="swiper-container">
      <div class="swiper-wrapper">
        {% for item in product.items %}
        <div class="swiper-slide">
          <div class="container">
            {% set image = "https://storage.googleapis.com/"+ bucket +"/"+item.imgfile1 %}
            <a href="{{url_for('product', product=item.productcode)}}"><img class="norm" src="{{image}}"></a>
            <div class="norm right">
              <span><a class="tag" href="{{url_for('gallery', filter=item.category)}}">{{item.category}} </a></span>
              {% for word in item.style.split("#") %}
              <span><a class="tag" href="{{url_for('gallery', filter=word)}}">{{word}} </a>|</span>
              {% endfor %}
              <span><a class="tag" href="{{url_for('view', name=item.owner_product.username)}}">{{item.owner_product.username}} </a></span>
            </div>
            {% if item.quantity > 0 %}
            <h4><a class = "bck button w40 center" href="{{url_for('product', product=item.productcode)}}">ดูข้อมูล</a></h4>
            <a class="blk" href="{{url_for('view', name=item.owner_product.username)}}">ดูแกลอรีของ {{item.owner_product.username}}</a>
            {% else %}
            <h4 class = 'center w40 red'>สินค้าหมด</h4>
            {% endif %}
            {% if item.promotion|int > 0 and time< item.promotion_expire %}
            <h4>
              <span class="discount">-{{item.promotion}}%</span><span class="highlight"> {{"฿ {:,.2f}".format((((item.price|int*(1-(item.promotion|int/100)))*margin)+item.shipping_fee|int)|round)}} </span><span class="linethrough">{{"{:,.2f}".format((item.price|int*margin)+item.shipping_fee|int)}}</span>
            </h4>
            {% else %}
            <h4>{{"฿ {:,.2f}".format((item.price|int*margin)+item.shipping_fee|int)}}</h4>
            {% endif %}
          </div>
        </div>
        {% endfor %}
      </div>
      <div class="break"></div>
      <!-- Add Pagination -->
      <div class="swiper-pagination"></div>
    </div>
    <div class="info-page">
      {% for page_num in product.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
          {% if product.page == page_num %}
            {% if filter == "gallery" %}
              <a class ="btn-page current" href="{{ url_for('gallery', page=page_num) }}">{{page_num}}</a>
            {% else %}
              <a class ="btn-page current" href="{{ url_for('gallery', filter=filter, page=page_num) }}">{{page_num}}</a>
            {% endif %}
          {% else %}
            {% if filter == "gallery" %}
              <a class ="btn-page" href="{{ url_for('gallery', page=page_num) }}">{{page_num}}</a>
            {% else %}
              <a class ="btn-page" href="{{ url_for('gallery', filter=filter, page=page_num) }}">{{page_num}}</a>
            {% endif %}
          {% endif %}
        {% else %}
          <a class ="btn-page">. . .</a>
        {% endif %}
      {% endfor %}
      {% if filter=="gallery"%}
        <a href="{{ url_for('gallery', page=product.next_num) }}" class="button fl-right">LOAD MORE</a>
      {% else %}
      <a href="{{ url_for('gallery', filter=filter, page=product.next_num) }}" class="button fl-right">LOAD MORE</a>
      {% endif %}
    </div>

<script type="text/javascript" src="{{ url_for('static',filename='js/swiper.js') }}"></script>

<!-- Initialize Swiper -->
<script>
  var swiper = new Swiper('.swiper-container', {
    pagination: {
      el: '.swiper-pagination',
    },
  });
</script>

{% endblock %}
